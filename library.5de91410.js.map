{"mappings":"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","sources":["src/library.js"],"sourcesContent":["import './sass/index.css';\nimport { getFilmDetails } from './api';\nimport { createMarkupForLibrary } from './markup';\nimport { createMarkupDetails } from './markup';\nimport { useModal } from './use_modal';\nimport { errorImage } from './error-image';\n\nconst btnWatchEl = document.querySelector('.js-library-btn-watch');\nconst btnQueEl = document.querySelector('.js-library-btn-que');\nconst filmListEl = document.querySelector('.js-film_list');\nconst paginationListEl = document.querySelector('.js-pagination__list');\nconst prevPageEl = document.querySelector(\".js-pagination__arrow_prev\");\nconst nextPageEl = document.querySelector(\".js-pagination__arrow_next\");\nconst backdropDescriptionEl = document.querySelector('.backdrop__description');\nconst backdropButtonsEl = document.querySelector('.backdrop__buttons');\nconst errorEl = document.querySelector(\".js-error\");\nconst loaderEl = document.querySelector('.loader');\n\n\nconst saveValueWatch = localStorage.getItem(\"watchFilm\");\nconst parseValueWatch = JSON.parse(saveValueWatch);\nconst saveValueQue = localStorage.getItem(\"queFilm\");\nconst parseValueQue = JSON.parse(saveValueQue);\n\nlet notesOnPage = 4;\nif (window.innerWidth > 767) {\n    notesOnPage = 6;\n}\nif (window.innerWidth > 1279) {\n    notesOnPage = 9;\n}\n\nbtnQueEl.addEventListener('click', onQueClick);\nbtnWatchEl.addEventListener('click', onWatchClick);\nfilmListEl.addEventListener('click', onFilmClick);\n\n\nbtnWatchEl.classList.add(\"active__btn\");\nloaderEl.style.display = 'none';\n\n\nfunction watchList(arr) {\n    paginationListEl.innerHTML = '';\n    filmListEl.innerHTML = createMarkupForLibrary(arr);\n    findGenres(arr);\n    pagination(arr);\n}\n\nwatchList(parseValueWatch);\n\nfunction onWatchClick() {\n    btnWatchEl.classList.add(\"active__btn\");\n    btnQueEl.classList.remove(\"active__btn\");\n    watchList(parseValueWatch);   \n}\n\nfunction onQueClick() {\n    btnWatchEl.classList.remove(\"active__btn\");\n    btnQueEl.classList.add(\"active__btn\");\n    watchList(parseValueQue);\n}\n\nfunction findGenres(arr) {\n    let filmsGenres = filmListEl.getElementsByClassName('filmsGenres');\n    for (let i = 0; i < filmsGenres.length; i += 1) {\n        let genre = arr[i].genres.map(genre => genre.name);\n        filmsGenres[i].textContent = genre.join(', ');\n    }\n}\n\n\nfunction pagination(arr) {\n    let countOfItems = Math.ceil(arr.length / notesOnPage)\n    for (let i = 1; i <= countOfItems; i += 1) {\n        let liEl = document.createElement(\"li\");\n        liEl.classList.add(\"pagination__item\");\n        liEl.classList.add(\"text\");\n        liEl.textContent = i;\n        paginationListEl.appendChild(liEl);\n    }\n\n    let active;\n    showPage(paginationListEl.children[0]);\n\n    for (let item of paginationListEl.children) {\n        item.addEventListener(\"click\", function () {\n            showPage(this);\n        });\n    }\n\n    function showPage(item) {\n        if (active) {\n            active.classList.remove(\"active\");\n        }\n        active = item;\n        item.classList.add(\"active\");\n        let pageNum = item.textContent;\n\n        let start = (pageNum - 1) * notesOnPage;\n        let end = start + notesOnPage;\n        let notes = arr.slice(start, end);\n    \n        filmListEl.innerHTML = createMarkupForLibrary(notes);\n        findGenres(notes);\n        hideOverPages();\n        errorImage(arr, filmListEl.children);\n    }\n\n    nextPageEl.addEventListener(\"click\", onNextPageClick);\n    prevPageEl.addEventListener(\"click\", onPrevPageClick);\n\n    function onNextPageClick() {\n        if (active.nextElementSibling) {\n            showPage(active.nextElementSibling);\n        }\n    }\n\n    function onPrevPageClick() {\n        if (active.previousElementSibling) {\n            showPage(active.previousElementSibling);\n        }\n    }\n\n    function hideOverPages() {\n        let items = [...paginationListEl.children];\n        if (items.length > 5) {\n            items.forEach((item) => item.classList.add(\"hide\"));\n            items[0].classList.remove(\"hide\");\n            try {\n                if (active.previousElementSibling) {\n                    active.previousElementSibling.classList.remove(\"hide\");\n                    active.previousElementSibling.previousElementSibling.classList.remove(\"hide\");\n                }\n\n                active.classList.remove(\"hide\");\n                if (active.nextElementSibling) {\n                    active.nextElementSibling.classList.remove(\"hide\");\n                    active.nextElementSibling.nextElementSibling.classList.remove(\"hide\");\n                }\n            }\n            catch {\n                if (active.previousElementSibling) {\n                    active.previousElementSibling.classList.remove(\"hide\");\n                }\n\n                active.classList.remove(\"hide\");\n                if (active.nextElementSibling) {\n                    active.nextElementSibling.classList.remove(\"hide\");\n                }\n            }\n        }\n    }\n}\n\nfunction fetchError() {\n    errorEl.style.display = \"block\";\n    prevPageEl.style.display = \"none\";\n    nextPageEl.style.display = \"none\";\n    loaderEl.style.display = 'none';\n}\n\nfunction onFilmClick(evt) {\n    if (evt.target === filmListEl) {\n        return\n    }\n    let filmId = evt.target.closest('.films__item').dataset.id;\n    useModal();\n    backdropButtonsEl.style.display = 'none';\n    backdropDescriptionEl.style.marginBottom = '0';\n    getFilmDetails(filmId)\n        .then((data) => {\n            backdropDescriptionEl.innerHTML = createMarkupDetails(data);\n            if (!data.poster_path) {\n                backdropDescriptionEl.children[0].src = \"./images/no-photo.png\";\n            }\n            loaderEl.style.display = 'none';\n        })\n        .catch(() => {\n            fetchError();\n        });\n}\n\n\n"],"names":["$8nrFW","parcelRequire","$cecbdd76f2d3d4bd$var$btnWatchEl","document","querySelector","$cecbdd76f2d3d4bd$var$btnQueEl","$cecbdd76f2d3d4bd$var$filmListEl","$cecbdd76f2d3d4bd$var$paginationListEl","$cecbdd76f2d3d4bd$var$prevPageEl","$cecbdd76f2d3d4bd$var$nextPageEl","$cecbdd76f2d3d4bd$var$backdropDescriptionEl","$cecbdd76f2d3d4bd$var$backdropButtonsEl","$cecbdd76f2d3d4bd$var$errorEl","$cecbdd76f2d3d4bd$var$loaderEl","$cecbdd76f2d3d4bd$var$saveValueWatch","localStorage","getItem","$cecbdd76f2d3d4bd$var$parseValueWatch","JSON","parse","$cecbdd76f2d3d4bd$var$saveValueQue","$cecbdd76f2d3d4bd$var$parseValueQue","$cecbdd76f2d3d4bd$var$notesOnPage","$cecbdd76f2d3d4bd$var$watchList","arr","innerHTML","$knNGv","createMarkupForLibrary","$cecbdd76f2d3d4bd$var$findGenres","active","countOfItems","Math","ceil","length","i","liEl","createElement","classList","add","textContent","appendChild","showPage","children","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","addEventListener","this","err","return","item","remove","start","end","notes","slice","hideOverPages","$71ZIC","errorImage","onNextPageClick","nextElementSibling","onPrevPageClick","previousElementSibling","items","$parcel$interopDefault","forEach","e","$cecbdd76f2d3d4bd$var$pagination","filmsGenres","getElementsByClassName","genre1","genres","map","genre","name","join","window","innerWidth","evt","target","filmId","closest","dataset","id","$a5TQa","useModal","style","display","marginBottom","$446fK","getFilmDetails","then","data","createMarkupDetails","poster_path","src","catch"],"version":3,"file":"library.5de91410.js.map"}