{"mappings":"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","sources":["src/api.js","src/markup.js","src/use_modal.js","src/error-image.js","src/library.js"],"sourcesContent":["const BASE_URL = 'https://api.themoviedb.org/3/';\nconst END_POINT_ALL = 'trending/movie/day';\nconst END_POINT_SEARCH = 'search/movie';\nconst END_POINT_DETAILS = 'movie/';\nconst KEY_API = '583e8699bc133adc4a2f7322eb108f1f';\n\nexport async function getAllFilms(page = 1) {\n    return await fetch(`${BASE_URL}${END_POINT_ALL}?api_key=${KEY_API}&page=${page}`)\n        .then(resp => {\n            if (!resp.ok) {\n                throw new Error(resp.statusText)\n            }\n            return resp.json();\n        })\n}\n\nexport async function getSearchFilms(searchQuery) {\n    return await fetch(`${BASE_URL}${END_POINT_SEARCH}?api_key=${KEY_API}&query=${searchQuery}`)\n        .then(resp => {\n            if (!resp.ok) {\n                throw new Error(resp.statusText)\n            }\n            return resp.json();\n        })\n}\n\nexport async function getFilmDetails(query) {\n    return await fetch(`${BASE_URL}${END_POINT_DETAILS}${query}?api_key=${KEY_API}`)\n        .then(resp => {\n            if (!resp.ok) {\n                throw new Error(resp.statusText)\n            }\n            return resp.json();\n        })\n}\n\nexport async function getGenres() {\n    const response = await fetch(`${BASE_URL}genre/movie/list?api_key=${KEY_API}`)\n    const genres = await response.json();\n    return genres;\n}","export function createMarkupFilms(arr) {\n    return arr.map(({ poster_path, title, release_date, id }) =>\n        `<li class=\"films__item\" data-id=\"${id}\">\n        <img class=\"films__img\" src=\"http://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${title}\">\n        <h3 class=\"films__description text\">${title}</h3>\n        <span class=\"filmsGenres\"></span>\n        <span class=\"films__description text films__release\"> | ${release_date.split(\"-\")[0]}</span>\n        </li>`).join('')\n}\n\nexport function createMarkupDetails(obj) {\n    const { poster_path, title, vote_average, vote_count, popularity, original_title,\n        genres, overview } = obj;\n    let filmGenres = genres.map(genre => genre.name).join(', ');\n    const markupDetails = `<img src=\"http://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${title}\" class=\"backdrop__description-img films__img\">\n        <div class=\"backdrop__info\"><h2 class=\"backdrop__description-title text\">${title}</h2>\n        <div class=\"backdrop__description-block\">\n        <p class=\"backdrop__description-option text\">Vote / Votes</p>\n        <div class=\"backdrop__description-value\">\n        <button class=\"text backdrop__description-vote\">${vote_average.toFixed(1)}</button>\n        <span class=\"text\">/</span>\n        <button class=\"text backdrop__description-vote vote_count\">${vote_count}</button></div>\n        <p class=\"backdrop__description-option text\">Popularity</p>\n        <p class=\"backdrop__description-value text\">${popularity.toFixed(1)}</p>\n        <p class=\"backdrop__description-option text\">Original Title</p>\n        <p class=\"backdrop__description-value text\">${original_title}</p>\n        <p class=\"backdrop__description-option text\">Genre</p>\n        <p class=\"backdrop__description-value text\">${filmGenres}</p>\n        </div>\n          <h3 class=\"backdrop__description-text_title text\">About</h3>\n          <p class=\"backdrop__description-text text\">${overview}</p></div>`;\n\n    return markupDetails;\n}\n\nexport function createMarkupForLibrary(arr) {\n    return arr.map(({ poster_path, title, release_date, id, vote_average }) =>\n        `<li class=\"films__item\" data-id=\"${id}\">\n        <img class=\"films__img\" src=\"http://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${title}\">\n        <h3 class=\"films__description text\">${title}</h3>\n        <div class=\"films__options\">\n        <span class=\"filmsGenres\"></span>\n        <span class=\"films__description text films__release\"> | ${release_date.split(\"-\")[0]}</span></div>\n        <button class=\"backdrop__description-vote library__description-vote\">${vote_average.toFixed(1)}</button>\n        </li>`).join('')\n}","export function useModal() {\n    const closeBtnEl = document.querySelector('.js-close-btn');\n    const backdropEl = document.querySelector('.js-backdrop');\n    const backdropModalEl = document.querySelector('.js-backdrop-modal');\n\n    backdropEl.classList.remove(\"is-hidden\");\n\n    closeBtnEl.addEventListener('click', onClickCloseBtn);\n    window.addEventListener('keydown', onEscPress);\n    window.addEventListener('mousedown', onMouseDown);\n\n    function onClickCloseBtn() {\n        backdropEl.classList.add(\"is-hidden\");\n    }\n\n    function onEscPress(evt) {\n        if (evt.code === 'Escape') {\n            backdropEl.classList.add(\"is-hidden\");\n        }\n        if (backdropEl.classList.contains(\"is-hidden\")) {\n            window.removeEventListener('keydown', onEscPress)\n        }\n    }\n\n    function onMouseDown(evt) {\n        if (!backdropModalEl.contains(evt.target)) {\n            backdropEl.classList.add(\"is-hidden\");\n        }\n        if (backdropEl.classList.contains(\"is-hidden\")) {\n            window.removeEventListener('mousedown', onMouseDown);\n        }\n    }\n}\n","\n\nexport function errorImage(arr, listEl) {\n    let errorImage = [];\n    arr.forEach(function (el) {\n        if (!el.poster_path) {\n            for (let i = 0; i < listEl.length; i += 1) {\n                if (listEl[i].dataset.id == el.id) {\n                    errorImage.push(listEl[i]);\n                }\n            }\n        }\n    })\n    errorImage.forEach(function (item) {\n        item.children[0].src = '/Filmoteka/no-photo.8c94442b.png';\n        console.log(item)\n    })\n}\n","import './sass/index.css';\nimport { getFilmDetails } from './api';\nimport { createMarkupForLibrary } from './markup';\nimport { createMarkupDetails } from './markup';\nimport { useModal } from './use_modal';\nimport { errorImage } from './error-image';\n\nconst btnWatchEl = document.querySelector('.js-library-btn-watch');\nconst btnQueEl = document.querySelector('.js-library-btn-que');\nconst filmListEl = document.querySelector('.js-film_list');\nconst paginationListEl = document.querySelector('.js-pagination__list');\nconst prevPageEl = document.querySelector(\".js-pagination__arrow_prev\");\nconst nextPageEl = document.querySelector(\".js-pagination__arrow_next\");\nconst backdropDescriptionEl = document.querySelector('.backdrop__description');\nconst backdropButtonsEl = document.querySelector('.backdrop__buttons');\nconst errorEl = document.querySelector(\".js-error\");\nconst loaderEl = document.querySelector('.loader');\n\n\nconst saveValueWatch = localStorage.getItem(\"watchFilm\");\nconst parseValueWatch = JSON.parse(saveValueWatch);\nconst saveValueQue = localStorage.getItem(\"queFilm\");\nconst parseValueQue = JSON.parse(saveValueQue);\n\nlet notesOnPage = 4;\nif (window.innerWidth > 767) {\n    notesOnPage = 6;\n}\nif (window.innerWidth > 1279) {\n    notesOnPage = 9;\n}\n\nbtnQueEl.addEventListener('click', onQueClick);\nbtnWatchEl.addEventListener('click', onWatchClick);\nfilmListEl.addEventListener('click', onFilmClick);\n\n\nbtnWatchEl.classList.add(\"active__btn\");\nloaderEl.style.display = 'none';\n\n\nfunction watchList(arr) {\n    paginationListEl.innerHTML = '';\n    filmListEl.innerHTML = createMarkupForLibrary(arr);\n    findGenres(arr);\n    pagination(arr);\n}\n\nwatchList(parseValueWatch);\n\nfunction onWatchClick() {\n    btnWatchEl.classList.add(\"active__btn\");\n    btnQueEl.classList.remove(\"active__btn\");\n    watchList(parseValueWatch);   \n}\n\nfunction onQueClick() {\n    btnWatchEl.classList.remove(\"active__btn\");\n    btnQueEl.classList.add(\"active__btn\");\n    watchList(parseValueQue);\n}\n\nfunction findGenres(arr) {\n    let filmsGenres = filmListEl.getElementsByClassName('filmsGenres');\n    for (let i = 0; i < filmsGenres.length; i += 1) {\n        let genre = arr[i].genres.map(genre => genre.name);\n        filmsGenres[i].textContent = genre.join(', ');\n    }\n}\n\n\nfunction pagination(arr) {\n    let countOfItems = Math.ceil(arr.length / notesOnPage)\n    for (let i = 1; i <= countOfItems; i += 1) {\n        let liEl = document.createElement(\"li\");\n        liEl.classList.add(\"pagination__item\");\n        liEl.classList.add(\"text\");\n        liEl.textContent = i;\n        paginationListEl.appendChild(liEl);\n    }\n\n    let active;\n    showPage(paginationListEl.children[0]);\n\n    for (let item of paginationListEl.children) {\n        item.addEventListener(\"click\", function () {\n            showPage(this);\n        });\n    }\n\n    function showPage(item) {\n        if (active) {\n            active.classList.remove(\"active\");\n        }\n        active = item;\n        item.classList.add(\"active\");\n        let pageNum = item.textContent;\n\n        let start = (pageNum - 1) * notesOnPage;\n        let end = start + notesOnPage;\n        let notes = arr.slice(start, end);\n    \n        filmListEl.innerHTML = createMarkupForLibrary(notes);\n        findGenres(notes);\n        hideOverPages();\n        errorImage(arr, filmListEl.children);\n    }\n\n    nextPageEl.addEventListener(\"click\", onNextPageClick);\n    prevPageEl.addEventListener(\"click\", onPrevPageClick);\n\n    function onNextPageClick() {\n        if (active.nextElementSibling) {\n            showPage(active.nextElementSibling);\n        }\n    }\n\n    function onPrevPageClick() {\n        if (active.previousElementSibling) {\n            showPage(active.previousElementSibling);\n        }\n    }\n\n    function hideOverPages() {\n        let items = [...paginationListEl.children];\n        if (items.length > 5) {\n            items.forEach((item) => item.classList.add(\"hide\"));\n            items[0].classList.remove(\"hide\");\n            try {\n                if (active.previousElementSibling) {\n                    active.previousElementSibling.classList.remove(\"hide\");\n                    active.previousElementSibling.previousElementSibling.classList.remove(\"hide\");\n                }\n\n                active.classList.remove(\"hide\");\n                if (active.nextElementSibling) {\n                    active.nextElementSibling.classList.remove(\"hide\");\n                    active.nextElementSibling.nextElementSibling.classList.remove(\"hide\");\n                }\n            }\n            catch {\n                if (active.previousElementSibling) {\n                    active.previousElementSibling.classList.remove(\"hide\");\n                }\n\n                active.classList.remove(\"hide\");\n                if (active.nextElementSibling) {\n                    active.nextElementSibling.classList.remove(\"hide\");\n                }\n            }\n        }\n    }\n}\n\nfunction fetchError() {\n    errorEl.style.display = \"block\";\n    prevPageEl.style.display = \"none\";\n    nextPageEl.style.display = \"none\";\n    loaderEl.style.display = 'none';\n}\n\nfunction onFilmClick(evt) {\n    if (evt.target === filmListEl) {\n        return\n    }\n    let filmId = evt.target.closest('.films__item').dataset.id;\n    useModal();\n    backdropButtonsEl.style.display = 'none';\n    backdropDescriptionEl.style.marginBottom = '0';\n    getFilmDetails(filmId)\n        .then((data) => {\n            backdropDescriptionEl.innerHTML = createMarkupDetails(data);\n            if (!data.poster_path) {\n                backdropDescriptionEl.children[0].src = \"./images/no-photo.png\";\n            }\n            loaderEl.style.display = 'none';\n        })\n        .catch(() => {\n            fetchError();\n        });\n}\n\n\n"],"names":["async","$2107b7db86dec8d6$export$cb9b4ba94b6f0493","query","fetch","then","resp","ok","Error","statusText","json","$88074c8a2c2a5e3d$export$93cf182b94770b04","obj","poster_path","title","vote_average","vote_count","popularity","original_title","genres","overview","filmGenres","map","genre","name","join","toFixed","$88074c8a2c2a5e3d$export$f3cdb16b83309bf3","arr","release_date","id","split","$e3620fae1184d15c$export$33ffd74ebf07f060","closeBtnEl","document","querySelector","backdropEl","backdropModalEl","classList","remove","addEventListener","add","window","onEscPress","evt","code","contains","removeEventListener","onMouseDown","target","$f3fbbd4dada940c9$export$75624d133646bc8a","listEl","errorImage1","forEach","el","i","length","dataset","push","item","children","src","console","log","$ce3726a01b8ab25a$var$btnWatchEl","$ce3726a01b8ab25a$var$btnQueEl","$ce3726a01b8ab25a$var$filmListEl","$ce3726a01b8ab25a$var$paginationListEl","$ce3726a01b8ab25a$var$prevPageEl","$ce3726a01b8ab25a$var$nextPageEl","$ce3726a01b8ab25a$var$backdropDescriptionEl","$ce3726a01b8ab25a$var$backdropButtonsEl","$ce3726a01b8ab25a$var$errorEl","$ce3726a01b8ab25a$var$loaderEl","$ce3726a01b8ab25a$var$saveValueWatch","localStorage","getItem","$ce3726a01b8ab25a$var$parseValueWatch","JSON","parse","$ce3726a01b8ab25a$var$saveValueQue","$ce3726a01b8ab25a$var$parseValueQue","$ce3726a01b8ab25a$var$notesOnPage","$ce3726a01b8ab25a$var$watchList","innerHTML","$ce3726a01b8ab25a$var$findGenres","active","countOfItems","Math","ceil","liEl","createElement","textContent","appendChild","showPage","item1","this","start","end","notes","slice","hideOverPages","onNextPageClick","nextElementSibling","onPrevPageClick","previousElementSibling","items","$ce3726a01b8ab25a$var$pagination","filmsGenres","getElementsByClassName","genre1","innerWidth","filmId","closest","style","display","marginBottom","data","catch"],"version":3,"file":"library.ee33e6f5.js.map"}