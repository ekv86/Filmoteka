async function e(e=1){return await fetch(`https://api.themoviedb.org/3/trending/movie/day?api_key=583e8699bc133adc4a2f7322eb108f1f&page=${e}`).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()}))}async function t(e){return await fetch(`https://api.themoviedb.org/3/search/movie?api_key=583e8699bc133adc4a2f7322eb108f1f&query=${e}`).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()}))}async function n(e){return await fetch(`https://api.themoviedb.org/3/movie/${e}?api_key=583e8699bc133adc4a2f7322eb108f1f`).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()}))}async function i(){const e=await fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=583e8699bc133adc4a2f7322eb108f1f");return await e.json()}function s(e){return e.map((({poster_path:e,title:t,release_date:n,id:i})=>`<li class="films__item" data-id="${i}">\n        <img class="films__img" src="http://image.tmdb.org/t/p/w500${e}" alt="${t}">\n        <h3 class="films__description text">${t}</h3>\n        <span class="filmsGenres"></span>\n        <span class="films__description text films__release"> | ${n.split("-")[0]}</span>\n        </li>`)).join("")}function o(e){const{poster_path:t,title:n,vote_average:i,vote_count:s,popularity:o,original_title:r,genres:l,overview:c}=e;let a=l.map((e=>e.name)).join(", ");return`<img src="http://image.tmdb.org/t/p/w500${t}" alt="${n}" class="backdrop__description-img films__img">\n        <div class="backdrop__info"><h2 class="backdrop__description-title text">${n}</h2>\n        <div class="backdrop__description-block">\n        <p class="backdrop__description-option text">Vote / Votes</p>\n        <div class="backdrop__description-value">\n        <button class="text backdrop__description-vote">${i.toFixed(1)}</button>\n        <span class="text">/</span>\n        <button class="text backdrop__description-vote vote_count">${s}</button></div>\n        <p class="backdrop__description-option text">Popularity</p>\n        <p class="backdrop__description-value text">${o.toFixed(1)}</p>\n        <p class="backdrop__description-option text">Original Title</p>\n        <p class="backdrop__description-value text">${r}</p>\n        <p class="backdrop__description-option text">Genre</p>\n        <p class="backdrop__description-value text">${a}</p>\n        </div>\n          <h3 class="backdrop__description-text_title text">About</h3>\n          <p class="backdrop__description-text text">${c}</p></div>`}function r(){const e=document.querySelector(".js-close-btn"),t=document.querySelector(".js-backdrop"),n=document.querySelector(".js-backdrop-modal");t.classList.remove("is-hidden"),e.addEventListener("click",(function(){t.classList.add("is-hidden")})),window.addEventListener("keydown",(function e(n){"Escape"===n.code&&t.classList.add("is-hidden");t.classList.contains("is-hidden")&&window.removeEventListener("keydown",e)})),window.addEventListener("mousedown",(function e(i){n.contains(i.target)||t.classList.add("is-hidden");t.classList.contains("is-hidden")&&window.removeEventListener("mousedown",e)}))}function l(e,t){let n=[];e.forEach((function(e){if(!e.poster_path)for(let i=0;i<t.length;i+=1)t[i].dataset.id==e.id&&n.push(t[i])})),n.forEach((function(e){e.children[0].src="/no-photo.6ebb93e4.png"}))}const c={keyWatchFilm:"watchFilm",keyQueFilm:"queFilm"},a=document.querySelector(".js-film_list"),d=document.querySelector(".js-film-form"),p=document.querySelector(".pagination"),u=document.querySelector(".js-pagination__list"),m=document.querySelector(".js-pagination__arrow_prev"),h=document.querySelector(".js-pagination__arrow_next"),f=document.querySelector(".backdrop__description"),_=document.querySelector(".js-btn-watch"),v=document.querySelector(".js-btn-que"),g=document.querySelector(".js-error"),b=document.querySelector(".js-error_search"),y=document.querySelector(".loader");let k=1,E={};var w;let L=null!==(w=JSON.parse(localStorage.getItem(c.keyWatchFilm)))&&void 0!==w?w:[];var S;let x=null!==(S=JSON.parse(localStorage.getItem(c.keyQueFilm)))&&void 0!==S?S:[];function j(){g.style.display="block",m.style.display="none",h.style.display="none",y.style.display="none"}function q(){b.style.display="block"}function $(e){i().then((t=>{let n=a.getElementsByClassName("filmsGenres"),i=[];for(let n=0;n<t.genres.length;n+=1){let n=[];for(let s=0;s<e.length;s+=1)n.splice(0,n.length),e[s].genre_ids.forEach((function(e){let i=t.genres.find((t=>t.id===e));n.push(i.name)})),i.push(n.join(", "))}for(let e=0;e<n.length;e+=1)n[e].textContent=i[e]})).catch((()=>{j()}))}if(d.addEventListener("submit",T),a.addEventListener("click",(function(e){if(e.target===a)return;let t=e.target.closest(".films__item").dataset.id;r(),n(t).then((e=>{f.innerHTML=o(e),E=e,e.poster_path||(f.children[0].src="/no-photo.6ebb93e4.png"),y.style.display="none"})).catch((()=>{j()})),E={}})),v.addEventListener("click",(function(){if(x.some((({id:e})=>Number(e)===E.id)))return;x.push(E),localStorage.setItem(c.keyQueFilm,JSON.stringify(x))})),_.addEventListener("click",(function(){if(L.some((({id:e})=>e===E.id)))return;L.push(E),localStorage.setItem(c.keyWatchFilm,JSON.stringify(L))})),e().then((t=>{a.insertAdjacentHTML("beforeend",s(t.results)),$(t.results),e().then((t=>{for(let e=1;e<=t.total_pages;e+=1){let t=document.createElement("li");t.classList.add("pagination__item"),t.classList.add("text"),t.textContent=e,u.appendChild(t)}let n;i(u.children[0]);for(let e of u.children)e.addEventListener("click",(function(){i(this)}));function i(t){n&&n.classList.remove("active"),n=t,t.classList.add("active"),k=t.textContent,e(k).then((e=>{a.insertAdjacentHTML("beforeend",s(e.results)),$(e.results),l(e.results,a.children),y.style.display="none"})).catch((()=>{j(),p.style.display="none"})),a.innerHTML="",c()}function o(){n.nextElementSibling&&i(n.nextElementSibling)}function r(){n.previousElementSibling&&i(n.previousElementSibling)}function c(){let e=[...u.children];if(e.length>5){e.forEach((e=>e.classList.add("hide"))),e[0].classList.remove("hide");try{n.previousElementSibling&&(n.previousElementSibling.classList.remove("hide"),n.previousElementSibling.previousElementSibling.classList.remove("hide")),n.classList.remove("hide"),n.nextElementSibling&&(n.nextElementSibling.classList.remove("hide"),n.nextElementSibling.nextElementSibling.classList.remove("hide"))}catch{n.previousElementSibling&&n.previousElementSibling.classList.remove("hide"),n.classList.remove("hide"),n.nextElementSibling&&n.nextElementSibling.classList.remove("hide")}}}h.addEventListener("click",o),m.addEventListener("click",r)})).catch((e=>console.log(e))),y.style.display="none"})).catch((()=>{j()})),d[0].value){window.addEventListener("keydown",(function e(t){"Enter"===t.code&&T();d[0].value||window.removeEventListener("keydown",e);console.log(t.code)}))}function T(e){e.preventDefault(),p.style.display="none",b.style.display="none";let n=e.currentTarget.searchQuery.value.toLowerCase().split(" ");for(let e=0;e<n.length;e+=1)n[e]=n[e][0].toUpperCase()+n[e].substr(1);t(n.join(" ")).then((e=>{if(console.log(e),a.innerHTML=s(e.results),$(e.results),l(e.results,a.children),e.results.forEach((function(e){if(!e.poster_path)throw new Error("There is no picture")})),!e.total_results)throw new q;a.innerHTML="",y.style.display="none"})).catch((()=>{console.log("There is no picture")})),e.currentTarget.searchQuery.value=""}
//# sourceMappingURL=index.ab0204ab.js.map
